--   -------------------------------------------------- 
--   Generated by Enterprise Architect Version 7.5.845
--   Created On : 星期五, 16 十一月, 2012 
--   DBMS       : MySql 
--   -------------------------------------------------- 


SET FOREIGN_KEY_CHECKS=0;


--  Drop Tables, Stored Procedures and Views 
DROP TABLE IF EXISTS F
;
DROP TABLE IF EXISTS FSM
;
DROP TABLE IF EXISTS Input
;
DROP TABLE IF EXISTS InputList
;
DROP TABLE IF EXISTS Link
;
DROP TABLE IF EXISTS Machine
;
DROP TABLE IF EXISTS Output
;
DROP TABLE IF EXISTS State
;

--  Create Tables 
CREATE TABLE F
(
	FID INTEGER NOT NULL AUTO_INCREMENT,
	StateID1 INTEGER COMMENT '原状态',
	InputID INTEGER,
	StatueID2 INTEGER COMMENT '新状态',
	OutputIDs TEXT COMMENT '用逗号隔开的输出编号',
	Remark TEXT,
	PRIMARY KEY (FID)
)  COMMENT='映射函数'
;


CREATE TABLE FSM
(
	FSMID INTEGER NOT NULL,
	Name NVARCHAR(50),
	FNID INTEGER COMMENT '父节点编号。',
	InitStateID INTEGER COMMENT '初始状态',
	PRIMARY KEY (FSMID)
)  COMMENT='有限状态机 的模型'
;


CREATE TABLE Input
(
	InputID INTEGER NOT NULL,
	Name NVARCHAR(50),
	FSMID INTEGER,
	Remark TEXT,
	PRIMARY KEY (InputID)
) 
;


CREATE TABLE InputList
(
	ILID INTEGER NOT NULL AUTO_INCREMENT COMMENT 'Input List ID',
	MachineID INTEGER,
	InputID INTEGER,
	Param TEXT COMMENT '输入的参数',
	PRIMARY KEY (ILID)
)  COMMENT='待处理的输入列表'
;


CREATE TABLE Link
(
	LinkID INTEGER NOT NULL AUTO_INCREMENT,
	Type VARCHAR(50) COMMENT 'i2i     输入到输入 o2i    输出到输入 o2o  输出到输出',
	MachineID1 INTEGER,
	ID1 INTEGER COMMENT '输入输出都可能',
	MachineID2 INTEGER,
	ID2 INTEGER COMMENT '输入输出都可能',
	PRIMARY KEY (LinkID)
)  COMMENT='输入输出之间的连接'
;


CREATE TABLE Machine
(
	MachineID INTEGER NOT NULL AUTO_INCREMENT,
	Name NVARCHAR(50),
	FSMID INTEGER,
	CurState INTEGER COMMENT '当前状态',
	OwnerUID INTEGER,
	PRIMARY KEY (MachineID)
)  COMMENT='一个具体的状态机'
;


CREATE TABLE Output
(
	OutputID INTEGER NOT NULL,
	Name NVARCHAR(50),
	FSMID INTEGER,
	Remark TEXT,
	PRIMARY KEY (OutputID)
) 
;


CREATE TABLE State
(
	StateID INTEGER NOT NULL,
	Name NVARCHAR(50),
	FSMID INTEGER,
	Remark TEXT,
	PRIMARY KEY (StateID)
)  COMMENT='状态'
;



SET FOREIGN_KEY_CHECKS=1;
